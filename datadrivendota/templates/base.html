{% load staticfiles navigation_extras steam_extras intercom_extras i18n %}
<!DOCTYPE html>
<html lang="en">

  <head>
    <title>{% block title %}datadrivendota{% endblock title %}</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Le styles -->

    <link rel="stylesheet" type="text/css" href="{% static 'dist/styles.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'dist/release.css' %}">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="//fonts.googleapis.com/css?family=Cinzel+Decorative" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Droid+Serif" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    {% block extra_css %}{% endblock extra_css %}
    {% comment %}
      Hack to get blog working for now.
    {% endcomment %}
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>

  </head>

  {# Google Analytics #}
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-51075768-1', 'auto');
    ga('send', 'pageview');
  </script>

  <body>

  <div id='bodyblock'>

    <div id='navigation'>
      <nav class="navbar navbar-inverse navbar-static-top" role="navigation" id='main-nav'>
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">DataDrivenDota<span class="brand-release-mark">beta</span></a>
        </div>

        {% block primary_nav %}
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">

          {% if SHOW_HEROES %}
            <li class="dropdown {% active 'heroes' main_nav %}">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Heroes <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="{% active 'heroes:index' %}"><a href="{% url 'heroes:index' %}">Index</a></li>
                <li role="presentation" class="divider"></li>
                <li role="presentation" class="dropdown-header">Advanced Charts</li>
                <li class="{% active 'heroes:vitals' %}"><a href="{% url 'heroes:vitals' %}">Vitals</a></li>
                <li class="{% active 'heroes:lineup' %}"><a href="{% url 'heroes:lineup' %}">Lineups</a></li>
              </ul>
            </li>
          {% endif %}

          {% if SHOW_MATCHES %}
            <li class="{% active 'matches' main_nav %}">
              <a href="{% url 'matches:index' %}">Matches</a>
            </li>
          {% endif %}

          {% if SHOW_PLAYERS %}
            <li class="{% active 'players:index' %}">
              <a href="{% url 'players:index' %}">Players</a>
            </li>
          {% endif %}

          {% if SHOW_TEAMS %}
            <li class="dropdown {% active 'teams' main_nav %}">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Teams <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="{% active 'teams:index' %}"><a href="{% url 'teams:index' %}">Team Index</a></li>
              </ul>
            </li>
          {% endif %}

          {% if SHOW_LEAGUES %}
            <li class="{% active 'leagues:overview' %}">
              <a href="{% url 'leagues:overview' %}">Leagues</a>
            </li>
          {% endif %}

          {% if SHOW_BLOG %}
            <li>
              <a href="{% url 'blog:entry' entry_id=1 %}">About</a>
            </li>
            <li class="{% active 'blog' main_nav %}">
              <a href="/blog/">Blog</a>
            </li>
          {% endif %}

          {% if SHOW_SEARCH %}
            <li class="{% active 'search' main_nav %}">
              <a href="{% url 'search' %}">Search</a>
            </li>
          {% endif %}

          {% if SHOW_PAYMENTS %}
            <li class="{% active 'premium' main_nav %}">
              <a class='brand-primary' href="">Premium</a>
            </li>
          </ul>
          {% endif %}

          {% if SHOW_AUTH %}
          <ul class="nav navbar-nav navbar-right">
            {% if user.is_active %}
            <li><a href="#">Data Management</a></li>
            <li><a href="{% url 'logout' %}">Logout, {{user}}?</a></li>
            {% else %}
            <li><a href="{% url 'login' method='email' %}">sign in</a></li>
            {% endif %}
          </ul>
          {% endif %}
        </div><!-- /.navbar-collapse -->
        {% endblock primary_nav %}
      </nav>
    </div>


    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}


    {% block sections %}
    {% endblock sections %}

    {% if show_control_bar %}
    <div id="control_bar_margin"></div>
    <div id="control_bar">
    {% include "matches/_time_control_card.html" %}
    </div>
    {% endif %}

    {% if show_date_control_bar %}
    <div id="control_bar_margin"></div>
    <div id="date_control_bar">
    {% include "matches/_date_combobox_card.html" %}
    </div>
    {% endif %}

  </div>
  <div id='footer'>
    <div class="container">
      <p>Copyright 2013 Deep Dive Data LLC. Dota 2 is a registered trademark of
      Valve Corporation.</p>  <p><a href="http://steampowered.com">Powered By
      Steam</a>, <a href="https://github.com/skadistats/clarity">Powered by clarity</a>.  Privacy stuff <a href="{% url 'privacy' %}">here</a>.  Email us at contact@datadrivendota.com.</p>
    </div>
  </div>
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    {% comment %}

    {% endcomment %}

    <script type="text/javascript" src='{% static "dist/built.js" %}'></script>
    <script type="text/javascript" src='{% static "js/d7.js" %}'></script>
    {% block extra_js %}
    {% endblock extra_js %}


    {% if user.is_authenticated %}
      <script id="IntercomSettingsScriptTag">
        window.intercomSettings = {
          user_id: "{% steam_id request.user %}",
          created_at: {{ request.user.date_joined|date:"U" }},
          user_hash: "{% intercom_user_hash request.user %}",
          widget: {
            activator: "#IntercomDefaultWidget"
          },
          app_id: "e089370216a8acf00a4718fd341c87883461a240",
          // Custom data
          steam_id: "{% steam_id request.user %}",
          name: "{{ request.user.username }}",
          avatar: "{% steam_avatar request.user %}"
        };
      </script>
      <script>
        (function () {
          var w = window;
          var ic = w.Intercom;
          if (typeof ic === "function") {
            ic('reattach_activator');
            ic('update', intercomSettings);
          } else {
            var d = document;
            var i = function () {
              i.c(arguments)
            };
            i.q = [];
            i.c = function (args) {
              i.q.push(args)
            };
            w.Intercom = i;
            function l() {
              var s = d.createElement('script');
              s.type = 'text/javascript';
              s.async = true;
              s.src = 'https://static.intercomcdn.com/intercom.v1.js';
              var x = d.getElementsByTagName('script')[0];
              x.parentNode.insertBefore(s, x);
            }
            if (w.attachEvent) {
              w.attachEvent('onload', l);
            } else {
              w.addEventListener('load', l, false);
            }
          };
        })()
      </script>
    {% endif %}
  </body>
</html>
